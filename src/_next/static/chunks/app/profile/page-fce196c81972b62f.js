(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{2093:function(e,a,s){Promise.resolve().then(s.bind(s,9939))},9939:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return o}});var t=s(7437),l=s(2926),r=s(2265),i=s(1654),n=s(5754),c=s(5179),d=s(9842),u=s(8523),m=s(660);function o(){let{user:e}=(0,l.d)(),[a,s]=(0,r.useState)(""),[o,x]=(0,r.useState)(!0),[f,h]=(0,r.useState)(!1),[j,v]=(0,r.useState)("");(0,r.useEffect)(()=>{e&&(async()=>{var a;if(null===(a=e.user_metadata)||void 0===a?void 0:a.username){s(e.user_metadata.username),x(!1);return}let{data:t,error:l}=await i.OQ.from("profiles").select("username").eq("id",e.id).single();!l&&t&&s(t.username||""),x(!1)})()},[e]);let b=async()=>{if(e){h(!0),v("");try{let{error:s}=await i.OQ.from("profiles").upsert({id:e.id,username:a,updated_at:new Date().toISOString()});if(s)throw s;let{error:t}=await i.OQ.auth.updateUser({data:{username:a}});if(t)throw t;v("资料已更新")}catch(e){v("错误: ".concat(e.message))}finally{h(!1)}}};return o?(0,t.jsxs)("main",{className:"min-h-screen",children:[(0,t.jsx)(m.default,{}),(0,t.jsx)(u.default,{}),(0,t.jsx)("div",{className:"container mx-auto px-4 py-8 flex items-center justify-center",children:(0,t.jsx)("div",{children:"加载中..."})})]}):(0,t.jsxs)("main",{className:"min-h-screen",children:[(0,t.jsx)(m.default,{}),(0,t.jsx)(u.default,{}),(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"max-w-md mx-auto glass-card p-6 rounded-xl",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-center text-lime-400 mb-6",children:"个人资料"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(d._,{htmlFor:"email",children:"邮箱"}),(0,t.jsx)(c.I,{id:"email",type:"email",value:(null==e?void 0:e.email)||"",disabled:!0,className:"bg-black/30 border-gray-800"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(d._,{htmlFor:"username",children:"用户名"}),(0,t.jsx)(c.I,{id:"username",value:a,onChange:e=>s(e.target.value),className:"bg-black/30 border-gray-800 focus:border-lime-500/50"})]}),j&&(0,t.jsx)("div",{className:"text-sm ".concat(j.includes("错误")?"text-red-500":"text-green-500"),children:j}),(0,t.jsx)(n.z,{onClick:b,disabled:f,className:"w-full bg-lime-500 hover:bg-lime-600 text-black",children:f?"更新中...":"更新资料"})]})]})})]})}}},function(e){e.O(0,[870,542,658,113,243,414,310,971,938,744],function(){return e(e.s=2093)}),_N_E=e.O()}]);